# Legendre-Lobatto 1D Sod shock tube (non-periodic BC)
problem: sod

grid:
  N: 4096
  Lx: 1.0
  basis: legendre
  bc: dirichlet       # reflective/dirichlet at endpoints for momentum
  dealias: false      # not applicable to non-Fourier bases
  precision: single
runtime:
  num_threads: 7   # or set an explicit integer, e.g., 8


physics:
  gamma: 1.4

integration:
  t0: 0.0
  t_end: 0.2
  cfl: 0.15           # smaller CFL due to clustered LGL nodes near boundaries
  scheme: rk78
  output_interval: 0.005
  checkpoint_interval: 0.01
  spectral_filter:
    enabled: true
    p: 8
    alpha: 36.0      # stronger modal filtering for discontinuities

adaptive:
  enabled: true
  scheme: rk78
  rtol: 1e-6
  atol: 1e-8
  safety_factor: 0.9
  min_dt_factor: 0.1
  max_dt_factor: 5.0
  max_rejections: 10
  fallback_scheme: rk4

artificial_viscosity:
  enabled: true
  nu_max: 0.005       # cap on viscosity strength (tunable)
  s_ref: 1.0
  s_min: 0.1
  p: 2.0
  epsilon: 1e-12
  sensor_variable: density

initial_conditions:
  left:
    rho: 1.0
    u: 0.0
    p: 1.0
  right:
    rho: 0.125
    u: 0.0
    p: 0.1

io:
  outdir: outputs/sod_legendre
  save_spectra: true


monitoring:
  enabled: true
  step_interval: 20
  include_conservation: true
  include_timestep: true
  include_time: true
  include_velocity_stats: true
  include_density_stats: true

video:
  fps: 30
  width: 1280
  height: 720
  scale: 1.5
  frame_dpi: 120
  codec: h264_videotoolbox
  crf: 20
  preset: medium
  pix_fmt: yuv420p


